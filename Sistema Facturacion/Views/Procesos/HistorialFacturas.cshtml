@model List<Sistema_Facturacion.Models.VistaFactura>
@{
    ViewBag.Title = "HistorialFacturas";
}

<h2>Historial Facturas</h2>

<form action="../Procesos/HistorialFacturas" method="post" onsubmit="guardar()">
    @Html.DropDownList("clienteId", new SelectList(ViewBag.Listacliente, "Id", "Nombre"), "Seleccionar",new {id="cliente" })
    <input type="date" name="fecha" id="fecha"/>
    <p>Que deseas ver?</p>
    <label><input type="checkbox" id="suma" name="suma" value="si"> Promedio</label><br>
    <label><input type="checkbox" id="promedio" name="promedio" value="si"> Suma</label><br>
    <label><input type="checkbox" id="conteo" name="conteo" value="si"> Conteo</label><br>
    @ViewBag.promedio
    @ViewBag.sumatoria
    @ViewBag.Conteo
    <input type="submit" value="BUSCAR" />
</form>

@using (Html.BeginForm("printFactura", "Procesos", FormMethod.Post, new { onsubmit = "obtenerDatos()" }))
{
    <input type="hidden" name="clienteId" id="clienteId" />
    <input type="hidden" name="fecha" id="fechav" />
    <input type="hidden" name="suma_" id="sumav" />
    <input type="hidden" name="promedio_" id="promediov" />
    <input type="hidden" name="conteo_" id="conteov" />
    <input type="submit" value="Generar reporte" />
}

<script>
    function guardar() {
        var cliente = document.getElementById("cliente").value;
        var fecha = document.getElementById("fecha").value;
        var suma_ = document.getElementById("suma").value;
        var promedio_ = document.getElementById("promedio").value;
        var conteo_ = document.getElementById("conteo").value;

        localStorage.setItem("cliente", cliente);
        localStorage.setItem("fecha", fecha);
        localStorage.setItem("suma_", suma_);
        localStorage.setItem("promedio_", promedio_);
        localStorage.setItem("conteo_", conteo_);

    }
    function obtenerDatos() {
        var cliente = localStorage.getItem("cliente");
        var fecha = localStorage.getItem("fecha");
        var suma_ = localStorage.getItem("suma_");
        var promedio_ = localStorage.getItem("promedio_");
        var conteo_ = localStorage.getItem("conteo_");

        document.getElementById("clienteId").value = cliente;
        document.getElementById("fechav").value=fecha;
        document.getElementById("sumav").value=suma_;
        document.getElementById("promediov").value=promedio_;
        document.getElementById("conteov").value=conteo_;
        localStorage.clear();
    }
</script>

<table>
    <thead>
        <tr>
            <th>Fecha</th>
            <th>Cliente</th>
            <th>Total</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.Fecha</td>
                <td>@item.Cliente</td>
                <td>@item.TotalPagado</td>
                <td>@Html.ActionLink("Detalle", "detalleFactura", new { id = item.Id })</td>
            </tr>
        }
    </tbody>
</table>
